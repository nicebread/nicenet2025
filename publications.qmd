---
title: "Publications"
description-meta: "Information, pdfs, and social metrics of papers"
#page-layout: full
#back-to-top-navigation: true
title-block-banner: false
css: custom.css
---


<!--Include academic icons or buttons-->
{{< include /files/includes/_academic.qmd >}}


```{r setup0}
#| include: false

library(knitr)
library(kableExtra)
library(rio)
library(openalexR)
library(OAmetrics)
library(dplyr)
library(htmltools)

knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo=FALSE,
  message=FALSE,
  warning=FALSE,
  out.width="100%"
)

# Set global chunk options for tables
options(knitr.table.format = "html")
```


```{r preprocess}
#| results: asis

publist <- import("files/publist.xlsx")
publist$doi <- normalize_dois(publist$doi)
publist <- publist %>% filter(!is.na(doi))

OAlex_papers <- oa_fetch(entity = "works", doi = normalize_dois(publist$doi))

OAlex_papers <- left_join(OAlex_papers, publist, by = "doi")

OAlex_papers <- OAlex_papers %>% 
    mutate(publication_date = as.Date(publication_date)) %>% 
    arrange(desc(publication_date))
# Build the publist

PL <- c()
for (y in unique(OAlex_papers$publication_year) |> sort(decreasing=TRUE)) {
    PL <- c(PL, paste0("<h2>", y, "</h2>"))

    OA_y <- OAlex_papers %>% 
        filter(publication_year == y) %>% 
        arrange(desc(publication_date))

    for (i in 1:nrow(OA_y)) {
        PL0 <- paste0(
            "<div class='reference'>",

            # ifelse(!is.na(OA_y[i, "OpenAccess"]), paste0(
            #     "<a href='", OA_y[i, "OpenAccess"], "'><img height='20' class='small_badge' src='files/images/oa_small.png' alt='oa_badge'></a>"), ""),
            # ifelse(!is.na(OA_y[i, "OpenData"]), paste0(
            #     "<a href='", OA_y[i, "OpenData"], "'><img height='20' class='small_badge' src='files/images/od_small.png' alt='open_data_badge'></a>"), ""),
            # ifelse(!is.na(OA_y[i, "OpenMaterial"]), paste0(
            #     "<a href='", OA_y[i, "OpenMaterial"], "'><img height='20' class='small_badge' src='files/images/om_small.png' alt='open_material_badge'></a>"), ""),
            # ifelse(!is.na(OA_y[i, "Preregistration"]), paste0(
            #     "<a href='", OA_y[i, "Preregistration"], "'><img height='20' class='small_badge' src='files/images/prereg_small.png' alt='prereg_badge'></a>"), ""),
            
            br(),

            OA_y[i, "display_name"],

            "<div class='buttons'>",
             ifelse(!is.na(OA_y[i, "OpenAccess"]), paste0(
                "<a href='", OA_y[i, "OpenAccess"], "'  class='button'><img height='20' src='files/images/oa_small.png' alt='oa_badge'> PDF</a>"), ""),
            ifelse(!is.na(OA_y[i, "OpenData"]), paste0(
                "<a href='", OA_y[i, "OpenData"], "'  class='button'><img height='20' src='files/images/od_small.png' alt='open_data_badge'> Open Data</a>"), ""),
            ifelse(!is.na(OA_y[i, "OpenMaterial"]), paste0(
                "<a href='", OA_y[i, "OpenMaterial"], "'  class='button'><img height='20' src='files/images/om_small.png' alt='open_material_badge'> Open Material</a>"), ""),
            ifelse(!is.na(OA_y[i, "Preregistration"]), paste0(
                "<a href='", OA_y[i, "Preregistration"], "'  class='button'><img height='20' src='files/images/prereg_small.png' alt='prereg_badge'> Preregistration</a>"), ""),
            "</div>",  # of .buttons
            "</div>"   # of .reference
        )
        
        PL <- c(PL, PL0)
    }
}

HTML(PL)
```


<!--Include social share buttons-->

<!-- {{< include /files/includes/_socialshare.qmd >}} -->